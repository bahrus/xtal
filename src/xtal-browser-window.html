<link rel="import" href="../bower_components/polymer/polymer-element.html">

<dom-module id="xtal-browser-window">
    <template>
        <span style="cursor:pointer" id="toggle_button" raised on-click="toggleIFrame">[[collapsedText]]</span> 
        <slot on-click="markClicked"></slot>
        <div id="div_iframe" 
            style$="display:none;border-style: inset;border-color: grey;overflow: scroll;height: 500px;width: {{width}}"
        >
            <iframe id="iframe" on-load="handleOnLoad" style="width:100%;height:1000%"></iframe>
        </div>
        <div id="div_noFrame">&nbsp;</div>
    </template>
    <script>
        class XtalBrowserWindow extends Polymer.Element {
            static get is() { return 'xtal-browser-window'; }
            static get properties(){
                return {
                    linkOnly:{
                        type: Boolean
                    },
                    sandBox:{
                        type: String
                    },
                    windowTop:{
                        type: Number
                    },
                    width:{
                        type: String,
                        value: '90%'
                    },
                    collapsedText:{
                        type: String,
                        value: '►'
                    },
                    clicked:{
                        type: Boolean,
                        notify: true,
                        reflectToAttribute: true
                    } 
                }
 
            }
            constructor() {
                super();
            }
            connectedCallback() {
                super.connectedCallback();
            }
            ready(){
                super.ready();
            }
            handleOnLoad(){
            }
            markClicked(){
                this.clicked = true;
            }
            toggleIFrame(){
                this.clicked = true;
                var aLink = this.children[0];
                if(this.linkOnly){
                    window.open(aLink.href);
                    return;
                }
                var iFrame = this.$.iframe;
                var toggleButton = this.$.toggle_button;
                var divIFrame = this.$.div_iframe;
                var div_noFrame = this.$.div_noFrame;
                if(divIFrame.style.display ==='none'){
                    divIFrame.style.display = 'block';
                    div_noFrame.style.display = 'none';
                    
                    iFrame.src = aLink.href;
                    toggleButton.innerText = '▼';
                }else{
                    iFrame.src='about:blank';
                    divIFrame.style.display = 'none';
                    div_noFrame.style.display = 'block';
                    toggleButton.innerText = this.collapsedText;
                }
                
            }
        }
        customElements.define(XtalBrowserWindow.is, XtalBrowserWindow);
    </script>
</dom-module>